# README โ Jarvis: Senpai

ูุณุฎูู ูพุฑูฺู: **Jarvis: Senpai** โ ุงูพ ฺุช/ูููุฏ ุฑุณุงูู ุจุง Streamlit ู Google Gemini

---

## ๐ ุฎูุงุตู

ุงู ูุฎุฒู ฺฉ ุงูพูฺฉุดู Streamlit ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ฺฉู ุงูฺฉุงูุงุช ุฒุฑ ุฑุง ุฏุงุฑุฏ:

* ูุฑูุฏ ู ุซุจุชโูุงู ฺฉุงุฑุจุฑุงู ุจุง JWT ู ุฑูุฒูฺฏุงุฑ `bcrypt`.
* ุฐุฎุฑูโุณุงุฒ ฺฉุงุฑุจุฑุงูุ ูฺฉุงููุงุช ู ูพุงูโูุง ุฏุฑ MongoDB ุจุง ุงุณุชูุงุฏู ุงุฒ `motor` (async).
* ฺุช ูุชู ุงุณุชุฑูโุดููุฏู ุจุง Google Gemini (ุงุณุชูุงุฏู ุงุฒ `google.generativeai`).
* ุชููุฏ ุฑุณุงูู (ุชุตูุฑ/ูุฏู) ุจูโุตูุฑุช placeholder (ูุงุจู ุชุนูุถ ุจุง API ูุงูุน).
* ุฑุงุจุท ฺฉุงุฑุจุฑ RTL ูุงุฑุณ ุจุง CSS ุณูุงุฑุด.
* ูุฏุฑุช ูุฏูโูุง (MODELS) ุจุง ููุงุด RPM/RPD ู ูุงุจูุชโูุง.

---

## ๐ง ูพุดโูุงุฒูุง

* Python 3.10+ (ุชุณุช ุดุฏู ุจุง 3.11/3.12/3.13)
* MongoDB (Atlas ุง ูุญู)
* ุฏุณุชุฑุณ ุจู ฺฉูุฏ Google Generative AI (GEMINI\_API\_KEY)
* ุจุณุชูโูุง (ุจุง `pip` ูุตุจ ฺฉูุฏ):

```bash
pip install -r requirements.txt
# ุง ุจูโุตูุฑุช ูุฌุฒุง
pip install streamlit motor pymongo bcrypt pyjwt google-generative-ai python-dotenv nest_asyncio pandas
```

---

## ๐๏ธ ูุชุบุฑูุง ูุญุท (Environment Variables)

ูุจู ุงุฒ ุงุฌุฑุงุ ููุงุฏุฑ ุฒุฑ ุฑุง ุฏุฑ ูุญุท ุณุฑูุฑ ุง `.env` ุชูุธู ฺฉูุฏ:

```env
MONGO_URI="mongodb+srv://<username>:<password>@cluster0.mongodb.net/mydb?retryWrites=true&w=majority"
GEMINI_API_KEY="sk-..."
JWT_SECRET_KEY="a-very-secret-key"
```

> **ูฺฉุชู:** ุฏุฑ ูุญุทโูุง ูุฒุจุงู ูุซู Render/Heroku/Render.com ูุชุบุฑูุง ูุญุท ุฑุง ุงุฒ ุฏุงุดุจูุฑุฏ ุณุฑูุณ ุชูุธู ฺฉูุฏุ ูู ูุงู `.env`.

---

## โถ๏ธ ุงุฌุฑุง ูุญู

```bash
export MONGO_URI="..."
export GEMINI_API_KEY="..."
export JWT_SECRET_KEY="..."
streamlit run app.py
```

ุง ุฏุฑ ููุฏูุฒ (PowerShell):

```powershell
$env:MONGO_URI = "..."
$env:GEMINI_API_KEY = "..."
$env:JWT_SECRET_KEY = "..."
streamlit run app.py
```

---

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู

```
โโ app.py                # ุงูพ ุงุตู (Jarvis: Senpai)
โโ requirements.txt      # ุจุณุชูโูุง ูพุงุชูู ูพุดููุงุฏ
โโ Dockerfile (ุงุฎุชุงุฑ) # ุจุฑุง ุณุงุฎุช ุงูุฌ ุฏุงฺฉุฑ
โโ README.md
```

---

## ๐งญ ูุนูุงุฑ ู ุฌุฑุงู ฺฉุงุฑ

1. ฺฉุงุฑุจุฑ ูุงุฑุฏ ุง ุซุจุชโูุงู ูโฺฉูุฏ. ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุฏุฑ collection `users` ุฐุฎุฑู ูโุดูุฏ.
2. ฺฉุงุฑุจุฑ ูฺฉุงููู ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูุฏ (collection `conversations`): ูุฑ ูฺฉุงููู ฺฉ ุณูุฏ ูุณุชูู ุฏุงุฑุฏ.
3. ูพุงูโูุง ฺฉุงุฑุจุฑ ู ูพุงุณุฎโูุง ุฏุฑ ุขุฑุงูู `messages` ุฏุงุฎู ุณูุฏ ูฺฉุงููู ุฐุฎุฑู ูโุดููุฏ.
4. ููฺฏุงู ุงุฑุณุงู ูพุงู ูุชูุ ุชุงุฑุฎฺูู ูพุงูโูุง ุจู ุดฺฉู ููุฑุฏ ุงูุชุธุงุฑ SDK ุจู Google Gemini ุงุฑุณุงู ูโุดูุฏ.
5. ูพุงุณุฎโูุง ุง ุจูโุตูุฑุช ุงุณุชุฑูโุดููุฏู ุจู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดููุฏ ุง ุฏุฑ ุญุงูุช ุฑุณุงููุ ููฺฉ ุชุตูุฑ/ูุฏู ุจู ฺฉุงุฑุจุฑ ูุดุงู ุฏุงุฏู ู ุฐุฎุฑู ูโุดูุฏ.

---

## โ๏ธ ูฺฉุงุช ูู ููู

* **Event loop**: ฺูู Streamlit ฺฉ loop ุฏุงุฎู ุฏุงุฑุฏุ ุงูพ ุงุฒ `nest_asyncio` ุงุณุชูุงุฏู ูโฺฉูุฏ ุชุง ุฎุทุง `RuntimeError: Event loop is closed` ุฑุฎ ูุฏูุฏ.
* **ุงุณุชุฑู Gemini**: ูุชุฏูุง ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ูุณุฎูโูุง ูุฎุชูู SDK ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏุ ุงฺฏุฑ SDK ุดูุง signature ูุชูุงูุช ุฏุงุฑุฏุ ูุงุฒู ุงุณุช `call_gemini_sync` ุง ูุชุฏ ุงุณุชุฑู ุฑุง ูุทุงุจู ุฏุงฺฉูููุช SDK ุขูพุฏุช ฺฉูุฏ.
* **ุชููุฏ ุฑุณุงูู**: ุฏุฑ ุญุงู ุญุงุถุฑ `generate_media_impl` placeholder ุงุณุช ู URLูุง ุชุตุงุฏู ุชููุฏ ูโฺฉูุฏ. ุจุฑุง ุงุชุตุงู ุจู API ุชููุฏ ุชุตูุฑ/ูุฏูุ ุขู ุชุงุจุน ุฑุง ุจุง ูุฑุงุฎูุงู ุฑุณู ุฌุงฺฏุฒู ฺฉูุฏ.
* **Pagination ูพุงูโูุง**: ูพุงูโูุง ุจุง limit ู offset ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ ุชุง ุณูุฏ ูฺฉุงููู ุณูฺฏู ูุดูุฏ.

---

## ๐งช ุชุณุช ู ุฎุทุงุงุจ (Troubleshooting)

* **ุฎุทุง Event loop is closed**: ุงฺฏุฑ ุฏุฑ ุงุฌุฑุง ุงู ุฎุทุง ุฑุง ุฏุฏุฏุ ูุทูุฆู ุดูุฏ `nest_asyncio.apply()` ูุจู ุงุฒ ุงุฌุฑุง ูุฑ ฺฉูุฑูุชู ูุฑุงุฎูุงู ุดุฏู ุงุณุช. ุฏุฑ ฺฉุฏ ุงู ฺฉุงุฑ ุงูุฌุงู ุดุฏู.
* **ูุดฺฉู ุงุชุตุงู MongoDB**:

  * ุขุฏุฑุณ `MONGO_URI` ุฑุง ุจุฑุฑุณ ฺฉูุฏ.
  * ุงฺฏุฑ ุงุฒ Atlas ุงุณุชูุงุฏู ูโฺฉูุฏุ IP ุณุฑููุฑ ุฑุง ุฏุฑ allow list ูุฑุงุฑ ุฏูุฏ ุง ุงุฒ connection string ููุงุณุจ ุงุณุชูุงุฏู ฺฉูุฏ.
* **ุฎุทุงูุง ูุฑุจูุท ุจู Gemini**:

  * ฺฉูุฏ API ูุนุชุจุฑ ุจุงุดุฏ ู quota ฺฉุงู ุฏุงุดุชู ุจุงุดุฏ.
  * ูุณุฎูู SDK ู ุฑูุด ูุฑุงุฎูุงู ูุชุฏูุง ููฺฉู ุงุณุช ุชุบุฑ ฺฉูุฏ โ ุฏุฑ ุตูุฑุช ุฎุทุงุ ูพุงู ุฎุทุง ู stack trace ุฑุง ุจุฑุฑุณ ู ุฏุงฺฉูููุช SDK ุฑุง ฺฺฉ ฺฉูุฏ.

---

## ๐ ุงุณุชูุฑุงุฑ (Deployment)

### Render / Heroku / Railway

* ูุชุบุฑูุง ูุญุท ุฑุง ุชูุธู ฺฉูุฏ (`MONGO_URI`, `GEMINI_API_KEY`, `JWT_SECRET_KEY`).
* ุฏุณุชูุฑ start ุฑุง `streamlit run app.py` ูุฑุงุฑ ุฏูุฏ.

### Docker (ูููููโ ุณุงุฏู)

```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt ./
RUN pip install --no-cache-dir -r requirements.txt
COPY . /app
CMD ["streamlit", "run", "app.py", "--server.port=8501", "--server.enableCORS=false"]
```

---

## ๐ ุงููุช

* JWT secret ุฑุง ูุฏุฑุชููุฏ ุงูุชุฎุงุจ ฺฉูุฏ.
* ูุฑุงูุจ ููุงุด ุฏุงุฏูโูุง ุญุณุงุณ ุฏุฑ ูุงฺฏโูุง ุจุงุดุฏ.
* ุจุฑุง production: HTTPS ู ูุญุฏูุฏุช IP ู rate-limiting ุฑุง ุฏุฑ ูุจูู ุดุจฺฉู ุงุนูุงู ฺฉูุฏ.

---

## โป๏ธ ุชูุณุนู ู ฺฏุณุชุฑุด

* ุฌุงฺฏุฒู `generate_media_impl` ุจุง API ูุงูุน ุชููุฏ ุชุตูุฑ/ูุฏู.
* ุงูุฒูุฏู ูุญุฏูุฏุช ู quota ฺฉุงุฑุจุฑุ ุณุณุชู ุงุดุชุฑุงฺฉ ุง ูุตุฑู ุงุนุชุจุงุฑ (credits).
* ูุงฺฏ ุณุงุฎุชุงุฑุงูุชู ุจู Sentryุ Datadog ุง ูุฑ ุณุฑูุณ ูุงูุชูุฑูฺฏ.
* ุงุถุงูู ฺฉุฑุฏู ุชุณุชโูุง ูุงุญุฏ ุจุง mocking ุจุฑุง `motor` ู `genai`.

---

## ๐งพ ูุณุช ูุฏูโูุง (MODELS)

ูุฏูโูุง ูพฺฉุฑุจูุฏโุดุฏู ุฏุฑ ุจุฑูุงูู:

* **ฺุช ูุชู**:

  * Gemini 2.5 Pro โ gemini-2.5-pro
  * Gemini 2.5 Flash โ gemini-2.5-flash
  * Gemini 2.5 Flash-Lite โ gemini-2.5-flash-lite
  * Gemini 2.0 Pro โ gemini-2.0-pro
  * Gemini 2.0 Flash โ gemini-2.0-flash

* **ุชููุฏ ุชุตูุฑ**:

  * Gemini 2.5 Flash Image โ gemini-2.5-flash-image-preview
  * Gemini 2.0 Flash Image โ gemini-2.0-flash-image

* **ุชููุฏ ูุฏู**:

  * Veo 3 โ veo-3

---

## โ ุณูุงูุงุช ูุชุฏุงูู

**Q: ุขุง ุงู ุจุฑูุงูู ูุฒููโูุง API ุฑุง ูุฏุฑุช ูโฺฉูุฏุ**
A: ูุนูุงู ูู. ุจุฑุง ูุฏุฑุช ูุฒูู ุจุงุฏ ูุงูู quota ุง credit ุฏุฑ ุณูุช ุณุฑูุฑ ุงุถุงูู ุดูุฏ.

**Q: ุขุง ุฏุงุฏูโูุง ุฑูุฒูฺฏุงุฑ ูโุดููุฏุ**
A: ุฑูุฒ ุนุจูุฑโูุง ุจุง bcrypt ูุด ูโุดููุฏุ ุงูุง ูุญุชูุง ูฺฉุงููุงุช ุฏุฑ ูพุงฺฏุงูโุฏุงุฏู ุจูโุตูุฑุช ูุชู ุฐุฎุฑู ูโุดูุฏ. ุงฺฏุฑ ูุงุฒ ุจู ุฑูุฒูฺฏุงุฑ ูพุงูโูุง ุฏุงุฑุฏุ ุจุงุฏ ุงุฒ encryption-at-rest ุง client-side encryption ุงุณุชูุงุฏู ฺฉูุฏ.

---

## โ๏ธ ฺฉูฺฉ ู ูุดุงุฑฺฉุช

Pull requests ูพุฐุฑูุชู ูโุดููุฏุ ูุทูุงู ุฏุฑ ุตูุฑุช ุงุฑุณุงู PRุ ฺฉ issue ุจุงุฒ ฺฉูุฏ ู ุชุบุฑุงุช ุฑุง ุชูุถุญ ุฏูุฏ.

---

## ๐งพ ูุฌูุฒ

ุงู ูพุฑูฺู ุชุญุช ูุฌูุฒ MIT ููุชุดุฑ ูโุดูุฏ (ุฏุฑ ุตูุฑุช ูุงุฒุ ฺฉ ูุงู LICENSE ุงุถุงูู ฺฉูุฏ).

---

**ุชููโุดุฏู ุชูุณุท:** ุชู ุชูุณุนูู Jarvis: Senpai
*ูููู ุจุงุดุฏ!*

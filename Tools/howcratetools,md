ุฑุงูููุง ููุง: ุณุงุฎุช ุงุจุฒุงุฑูุง ุณูุงุฑุด ุจุฑุง Saino Elite v3.0ูุนูุงุฑ ุฌุฏุฏ Saino Elite ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุจู ุฑุงุญุช ุงุจุฒุงุฑูุง ูพุงุชูู ุฎูุฏ ุฑุง ุจุณุงุฒุฏ ู ุขูโูุง ุฑุง ุจู ุตูุฑุช ูพูุง ุจู ุจุฑูุงูู ุงุถุงูู ฺฉูุฏ. ูุฑ ุงุจุฒุงุฑ ุฌุฏุฏุ ฺฉ ูุงุจูุช ุชุงุฒู ุจู Agent ููุดููุฏ ุดูุง ูโุจุฎุดุฏ.ููููู ุงุตูุจุฑูุงูู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุงูโูุง ูพุงุชูู ููุฌูุฏ ุฏุฑ ูพูุดู tools/ ุฑุง ุงุณฺฉู ฺฉุฑุฏู ู ูุฑ ฺฉูุงุณ ฺฉู ุงุฒ BaseTool ุงุฑุซโุจุฑ ฺฉุฑุฏู ุจุงุดุฏ ุฑุง ุจู ุนููุงู ฺฉ ุงุจุฒุงุฑ ุฌุฏุฏ ุดูุงุณุง ู ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.ุณุงุฎุชุงุฑ ฺฉ ุงุจุฒุงุฑูุฑ ุงุจุฒุงุฑ ุจุงุฏ ุฏุฑ ฺฉ ูุงู ูพุงุชูู ูุฌุฒุง ุฏุฑ ูพูุดู tools/ ูุฑุงุฑ ฺฏุฑุฏ ู ุณุงุฎุชุงุฑ ุฒุฑ ุฑุง ุฏุงุดุชู ุจุงุดุฏ:ฺฉูุงุณ BaseToolุงู ฺฉ ฺฉูุงุณ ูพุงู ุงูุชุฒุงุน (Abstract) ุงุณุช ฺฉู ุณุงุฎุชุงุฑ ุงุตู ูุฑ ุงุจุฒุงุฑ ุฑุง ุชุนุฑู ูโฺฉูุฏ. ุดูุง ุจุงุฏ ุงุฒ ุงู ฺฉูุงุณ ุงุฑุซโุจุฑ ฺฉูุฏ.name (str): ููู: ูุงู ููุญุตุฑ ุจู ูุฑุฏ ุงุจุฒุงุฑ (ุงูฺฏูุณ ู ุจุฏูู ูุงุตูู). ุงู ูุงู ุชูุณุท ูุฏู LLM ุจุฑุง ูุฑุงุฎูุงู ุงุจุฒุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ.description (str): ุจุณุงุฑ ููู: ุชูุถุญ ฺฉุงูู ู ุฏูู ุนููฺฉุฑุฏ ุงุจุฒุงุฑ ุจู ุฒุจุงู ุทุจุน. ุงู ุชูุถุญ ุจู ูุฏู ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจูููุฏ ฺู ุฒูุงู ู ฺุฑุง ุจุงุฏ ุงุฒ ุงู ุงุจุฒุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ. ูุฑฺู ุงู ุชูุถุญ ุจูุชุฑ ุจุงุดุฏุ ุนููฺฉุฑุฏ Agent ุดูุง ููุดููุฏุชุฑ ุฎูุงูุฏ ุจูุฏ.parameters (dict): ฺฉ ุฏฺฉุดูุฑ ูุทุงุจู ุจุง ุงุณุชุงูุฏุงุฑุฏ JSON Schema ฺฉู ูพุงุฑุงูุชุฑูุง ูุฑูุฏ ุงุจุฒุงุฑ ุดูุง ุฑุง ุชุนุฑู ูโฺฉูุฏ. ุงู ุจู ูุฏู ูโูููุงูุฏ ฺฉู ฺู ุงุทูุงุนุงุช ุฑุง ุจุงุฏ ุจุฑุง ุงุฌุฑุง ุงุจุฒุงุฑ ูุฑุงูู ฺฉูุฏ.execute(self, **kwargs) (async def): ูุชุฏ ุงุตู ฺฉู ููุทู ุงุจุฒุงุฑ ุดูุง ุฏุฑ ุขู ูพุงุฏูโุณุงุฒ ูโุดูุฏ. ุงู ูุชุฏ ุจุงุฏ ุจู ุตูุฑุช async ุชุนุฑู ุดูุฏ ู ฺฉ ุฏฺฉุดูุฑ ุจู ุนููุงู ุฎุฑูุฌ ุจุฑฺฏุฑุฏุงูุฏ.ูุซุงู ฺฉุงูู: ุณุงุฎุช ุงุจุฒุงุฑ get_weatherูุฑุถ ฺฉูุฏ ูโุฎูุงูู ุงุจุฒุงุฑ ุจุณุงุฒู ฺฉู ุขุจโูููุง ฺฉ ุดูุฑ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ API ุฎุงุฑุฌ ุงุนูุงู ฺฉูุฏ.ฑ. ูุตุจ ฺฉุชุงุจุฎุงูู: ุงุจุชุฏุง ฺฉุชุงุจุฎุงูู ููุฑุฏ ูุงุฒ ุจุฑุง ุฏุฑุฎูุงุณุชโูุง ูุจ ุฑุง ูุตุจ ูโฺฉูู: pip install aiohttpฒ. ุงุฌุงุฏ ูุงู: ฺฉ ูุงู ุฌุฏุฏ ุจู ูุงู weather_tool.py ุฏุฑ ูพูุดู tools/ ุงุฌุงุฏ ฺฉูุฏ.ณ. ููุดุชู ฺฉุฏ: ูุญุชูุง ูุงู ุฑุง ุจู ุตูุฑุช ุฒุฑ ุจููุณุฏ:# tools/weather_tool.py

# ูุงุฑุฏ ฺฉุฑุฏู ฺฉูุงุณ ูพุงู ู ุณุงุฑ ูุงุฒููุฏโูุง
# ุชูุฌู: __main__ ุจู ูุงู ุงุตู ุจุฑูุงูู (saino_v3_final.py) ุงุดุงุฑู ุฏุงุฑุฏ
# ุงู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุจู ูุชุบุฑูุง ุณุฑุงุณุฑ ูุงููุฏ logger ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.
from __main__ import BaseTool, logger
import aiohttp 
import chainlit as cl # ุจุฑุง ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ ุฏุฑ ุญู ุงุฌุฑุง

class WeatherTool(BaseTool):
    # ฑ. ุชุนุฑู ูุงู ู ุชูุถุญุงุช
    name = "get_weather"
    description = "ุงุทูุงุนุงุช ุขุจโูููุง ูุนู ฺฉ ุดูุฑ ุฎุงุต ุฑุง ุงุฒ ฺฉ ุณุฑูุณ ุขููุงู ุฏุฑุงูุช ูโฺฉูุฏ."

    # ฒ. ุชุนุฑู ูพุงุฑุงูุชุฑูุง ูุฑูุฏ ุจุง JSON Schema
    parameters = {
        "type": "object",
        "properties": {
            "city": {
                "type": "string",
                "description": "ูุงู ุดูุฑุ ุจู ุนููุงู ูุซุงู: Tehran"
            },
            "unit": {
                "type": "string",
                "description": "ูุงุญุฏ ุฏูุงุ 'celsius' ุง 'fahrenheit'. ูพุดโูุฑุถ 'celsius' ุงุณุช.",
                "enum": ["celsius", "fahrenheit"]
            }
        },
        "required": ["city"], # ูพุงุฑุงูุชุฑ city ุงุฌุจุงุฑ ุงุณุช
    }

    # ณ. ูพุงุฏูโุณุงุฒ ููุทู ุงุฌุฑุง ุงุจุฒุงุฑ
    async def execute(self, city: str, unit: str = "celsius") -> dict:
        logger.info(f"ุงุจุฒุงุฑ ุขุจโูููุง ุจุฑุง ุดูุฑ '{city}' ูุฑุงุฎูุงู ุดุฏ.")
        
        # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ ฺฉู ูุฑุขูุฏ ุดุฑูุน ุดุฏู ุงุณุช
        await cl.Message(content=f"๐ฆ๏ธ ุฏุฑ ุญุงู ุฏุฑุงูุช ุงุทูุงุนุงุช ุขุจโูููุง ุจุฑุง ุดูุฑ {city}...").send()

        # ุฏุฑ ุงูุฌุง ุจุงุฏ ุจู ฺฉ API ูุงูุน ุขุจโูููุง ูุชุตู ุดูุฏ.
        # ุจุฑุง ุงู ูุซุงูุ ุงุฒ ฺฉ API ุฑุงฺฏุงู ุงุณุชูุงุฏู ูโฺฉูู.
        API_URL = f"[https://wttr.in/](https://wttr.in/){city}?format=j1"
        
        try:
            async with aiohttp.ClientSession() as session:
                async with session.get(API_URL) as response:
                    response.raise_for_status() # ุงฺฏุฑ ุฎุทุง ุจูุฏุ Exception ุงุฌุงุฏ ูโฺฉูุฏ
                    data = await response.json()

            current_condition = data['current_condition'][0]
            temp_key = 'temp_C' if unit == 'celsius' else 'temp_F'
            
            result = {
                "city": data['nearest_area'][0]['areaName'][0]['value'],
                "temperature": current_condition[temp_key],
                "condition": current_condition['weatherDesc'][0]['value'],
                "humidity": current_condition['humidity'] + "%",
                "wind_speed": current_condition['windspeedKmph'] + " km/h",
                "unit": unit
            }
            
            # ุฎุฑูุฌ ูููู ุจุงุฏ ฺฉ ุฏฺฉุดูุฑ ุจุง status='ok' ุจุงุดุฏ
            return {"status": "ok", "data": result}

        except Exception as e:
            logger.error(f"ุฎุทุง ุฏุฑ ุฏุฑุงูุช ุงุทูุงุนุงุช ุขุจโูููุง: {e}")
            # ุฎุฑูุฌ ูุงูููู ุจุงุฏ ุดุงูู ฺฉูุฏ error ุจุงุดุฏ
            return {"status": "error", "error": f"ุงุทูุงุนุงุช ุขุจโูููุง ุจุฑุง ุดูุฑ '{city}' ุงูุช ูุดุฏ. ูุทูุงู ูุงู ุดูุฑ ุฑุง ุจู ุงูฺฏูุณ ูุงุฑุฏ ฺฉูุฏ."}

ูฺฉุงุช ฺฉูุฏ ู ุจูุชุฑู ุดููโูุงุชูุถุญุงุช ุฏูู (Description): ุงู ูููโุชุฑู ุจุฎุด ุงุจุฒุงุฑ ุดูุงุณุช. ุขู ุฑุง ุทูุฑ ุจููุณุฏ ฺฉู ฺฉ ุงูุณุงู ุจุชูุงูุฏ ุจูููุฏ ุงุจุฒุงุฑ ุดูุง ฺู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ. ุงุฒ ูุซุงู ุฒุฏู ูุชุฑุณุฏ.ุฎุฑูุฌ ุงุณุชุงูุฏุงุฑุฏ: ููุดู ุฎุฑูุฌ ูุชุฏ execute ุฑุง ุจู ุตูุฑุช ฺฉ ุฏฺฉุดูุฑ ุจุง ฺฉูุฏ status ุจุฑฺฏุฑุฏุงูุฏ.ุฏุฑ ุตูุฑุช ููููุช: {"status": "ok", "data": ...}ุฏุฑ ุตูุฑุช ุดฺฉุณุช: {"status": "error", "error": "ุชูุถุญ ุฎุทุง"}ูุฏุฑุช ุฎุทุง: ููุดู ฺฉุฏูุง ุฎูุฏ ุฑุง ุฏุงุฎู ุจููฺฉ try...except ูุฑุงุฑ ุฏูุฏ ุชุง ุฎุทุงูุง ุบุฑููุชุธุฑู ุจุงุนุซ ุงุฒ ฺฉุงุฑ ุงูุชุงุฏู ฺฉู ุจุฑูุงูู ูุดููุฏ.ุงุทูุงุนโุฑุณุงู ุจู ฺฉุงุฑุจุฑ: ุงุณุชูุงุฏู ุงุฒ cl.Message ุฏุฑ ุฏุงุฎู ุงุจุฒุงุฑุ ุชุฌุฑุจู ฺฉุงุฑุจุฑ ุจูุชุฑ ุงุฌุงุฏ ูโฺฉูุฏุ ุฒุฑุง ฺฉุงุฑุจุฑ ูุชูุฌู ูโุดูุฏ ฺฉู Agent ุฏุฑ ุญุงู ุงูุฌุงู ฺู ฺฉุงุฑ ุงุณุช.ุณุงุฏฺฏ: ุงุจุฒุงุฑูุง ุฎูุฏ ุฑุง ุชุง ุญุฏ ุงูฺฉุงู ุณุงุฏู ู ุชฺฉโููุธูุฑู ุทุฑุงุญ ฺฉูุฏ. ุจู ุฌุง ฺฉ ุงุจุฒุงุฑ ูพฺุฏู ฺฉู ุฏู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏุ ุฏู ุงุจุฒุงุฑ ุณุงุฏู ุจุณุงุฒุฏ.ุจุง ุฏูุจุงู ฺฉุฑุฏู ุงู ุฑุงูููุงุ ุดูุง ูโุชูุงูุฏ ุจู ุณุงุฏฺฏ ู ุจู ุณุฑุนุชุ ูุงุจูุชโูุง Agent ููุดููุฏ Saino Elite ุฑุง ฺฏุณุชุฑุด ุฏูุฏ.
